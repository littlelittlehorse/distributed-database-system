# 哈希表

本节开始之前，先看一下目前课程的进度状态：

![](https://user-images.githubusercontent.com/95269537/168838043-b72ac943-fb93-46d2-a3f3-1edd47ca1349.png)

为了支持 DBMS 更高效地从 pages 中读取数据，DBMS 的设计者需要灵活运用一些数据结构及算法，其中对于 DBMS 最重要的两个是 : 

- 哈希表
- 树

它们可能被用在 DBMS 的多个地方，包括 : 
- 内部元数据 : 数据库和系统的状态信息。
- 核心数据存储 : 数据库中 tuple 的存储。
- 临时数据结构 : 查询过程中构建的数据。
- 表索引 : 辅助数据结构，找到特定的 tuple。

设计需要考量的因素 : 
1. 数据组织 : 如何布局内部，以及数据结构存储那些信息。
2. 并发 : 如何支持数据的并发访问、修改。

## 哈希表设计

哈希表实现了 key 到 value 的映射。

哈希表主要分为两部分 :

1. 哈希函数 : 如何实现将大 key 空间映射到较小的空间中。需要权衡速度和冲突率。
2. 哈希方案 : 如何在哈希后处理哈希冲突。需要权衡分配大的哈希表以减少冲突概率还是执行其他指令去查找和插入 key。


### 哈希函数

DBMS 的哈希函数不需要考虑加密，因为不暴露给用户。目标是速度快、哈希冲突率低。

### 哈希方案

解决哈希冲突的方法。

1. 开放定址法/再散列法 : 当关键字 key 的哈希地址 p=hash(key) 发生冲突时，以 p 为基础，找到另一个哈希地址 p1，p1 冲突，再以 p 产生另一个地址 p2，直至找到一个不冲突的地址 pi。
2. 再哈希法 : 同时构造多个哈希函数。当 p1=hash1(key) 发生冲突时，换一个 hash 函数，计算 p2=hash2(key)...。
3. 链地址法 : 将哈希地址为 p 的所有元素构成一个同义词的链表，查找、删除、更新都需要遍历链表。


### 动态哈希

动态哈希不同于静态哈希需要预判最终的数据量大小，动态哈希可以按需扩容，本节介绍三种常见的动态哈希 :
- Chained Hash
- Extendible Hashing
- Linear Hashing

略。



## Reference

[CMU 15-445 哈希表](https://zhenghe.gitbook.io/open-courses/cmu-15-445-645-database-systems/hash-tables)
